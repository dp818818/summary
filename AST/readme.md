幡然醒悟篇之AST抽象语法树！

抽象语法树(AST)也是Vue的核心内容，也不仅仅限于Vue，如在Babel中的运用，在Vue中它也是虚拟节点的上一步，虚拟节点就是通过抽象语法树得来的，但是它很简单，因为它不需要去做diff，节点的diff是通过虚拟节点进行的！


dom更新的过程：

简写Vue抽象语法树，
抽象语法树我们手写的话也就两段代码: 1.扫描模板生成AST语法树    2.改变attrs结构

1.扫描模板生成AST语法树：

在写代码前，我们应该要了解栈的概念：什么是栈？先进去，后出来。

<div class='abc'  id='efg' ref='hijk'> <ul> <li>苹果</li> <li>橘子</li> <li>菠萝</li> </ul></div>


指针扫描的思想在Vue中可以说是很多地方都用到了，如抽象语法树，虚拟dom的diff算法等。



这里是运用到了指针与正则，正则不会的话也没有关系，不影响生成抽象语法树的思路,毕竟我们这个也是一个最简版的！

我们需要两个栈 ： stack1 = []  ,  stack2 = [{ children: [] }] 

这里扫描模板时，会有3个判断：
example:  <div id='123'  class='456'>你好</div>

1.扫描到标签开始，如：<div id='123'>  div入stack1栈 ， 语法树：{'tag':'div','children':[],'attrs':{ id='123'  class='456'} }入stack2栈  

2.扫描到标签中间的内容，如：你好 ； （文本）stack2栈顶加入文本节点 {'text':'你好','type':3}

3.扫描到标签结束，如：</div>  stack1栈顶出栈， stack2栈顶出栈并移到stack2新的栈顶的children中（出栈了它下一项就是新的栈顶了,这样就可以保证语法树的结构了）


然后我们再改变下attrs的结构就行了： " id='123'|   class='456'|" 这里也是扫描，扫到双数 ' 就截取到数组中。  




